<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Sparse Grid Integration · SparseGridsKit</title><meta name="title" content="Sparse Grid Integration · SparseGridsKit"/><meta property="og:title" content="Sparse Grid Integration · SparseGridsKit"/><meta property="twitter:title" content="Sparse Grid Integration · SparseGridsKit"/><meta name="description" content="Documentation for SparseGridsKit."/><meta property="og:description" content="Documentation for SparseGridsKit."/><meta property="twitter:description" content="Documentation for SparseGridsKit."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SparseGridsKit</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">SparseGridsKit</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../multiindexsets/">Multi-Index Sets</a></li><li><a class="tocitem" href="../sparsegridinterpolation/">Sparse Grid Interpolation</a></li><li class="is-active"><a class="tocitem" href>Sparse Grid Integration</a><ul class="internal"><li><a class="tocitem" href="#Sparse-Grid-Integration-2"><span>Sparse Grid Integration</span></a></li><li><a class="tocitem" href="#Sparse-Grid-L2(Gamma)-Norms"><span>Sparse Grid L^2(Gamma) Norms</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Sparse Grid Integration</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Sparse Grid Integration</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/benmkent/SparseGridsKit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/benmkent/SparseGridsKit.jl/blob/main/docs/src/sparsegridintegration.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Sparse-Grid-Integration"><a class="docs-heading-anchor" href="#Sparse-Grid-Integration">Sparse Grid Integration</a><a id="Sparse-Grid-Integration-1"></a><a class="docs-heading-anchor-permalink" href="#Sparse-Grid-Integration" title="Permalink"></a></h1><p>Sparse grid interpolation in <code>SparseGridsKit.jl</code> relies on precomputed integrals of the Lagrange interpolation polynomials.</p><p>Integrals are currently computed solely assuming Clenshaw–Curtis points and a density function <span>$\rho=\frac{1}{2}^{n}$</span> where <span>$n$</span> is the dimension of the parameter space <span>$\Gamma=[-1,1]^{n}$</span></p><p>To do this a maximum level number is selected.</p><pre><code class="language-julia hljs">    using SparseGridsKit, LinearAlgebra
    pcl = precompute_lagrange_integrals(7)
    pcl[2,1,:,:]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">65×65 Matrix{Float64}:
 0.166667  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.666667  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.166667  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 ⋮                             ⋮         ⋱            ⋮                   
 0.0       0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0       0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0</code></pre><h2 id="Sparse-Grid-Integration-2"><a class="docs-heading-anchor" href="#Sparse-Grid-Integration-2">Sparse Grid Integration</a><a class="docs-heading-anchor-permalink" href="#Sparse-Grid-Integration-2" title="Permalink"></a></h2><p>This is then used to integrate a sparse grid polynomial approximation. Consider the function <span>$f:[-1,1]\to\R$</span></p><pre><code class="language-julia hljs">    f(x) = @. 3.0*x^2 + 2.0*x + 1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">f (generic function with 1 method)</code></pre><p>The two-dimension function <span>$[f(x_1) f(x_2)^2]$</span> mapping <span>$[-1,1]^2 \to \R^2$</span> can be approximated using a constant function. The integral is expected (albeit a poor approximation to the true value).</p><pre><code class="language-julia hljs">    n,k = 2,0
    mi_set = create_smolyak_miset(n,k)
    sg = create_sparsegrid(mi_set)
    f_on_grid = [[f(x[1]), f(x[2])^2] for x in get_grid_points(sg)]
    # Test integrate_on_sparsegrid
    integral_result = integrate_on_sparsegrid(sg, f_on_grid, pcl)
    integral_result ≈ [1.0,1.0]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>The integral estimate is improved by using a sparse grid with more grid points. The integral can be evaluated explicitly, and it is seen that the quadrature gets the correct result.</p><pre><code class="language-julia hljs">    n,k = 2,4
    mi_set = create_smolyak_miset(n,k)
    sg = create_sparsegrid(mi_set)
    f_on_grid = [[f(x[1]), f(x[2])^2] for x in get_grid_points(sg)]
    # Test integrate_on_sparsegrid
    integral_result = integrate_on_sparsegrid(sg, f_on_grid, pcl)

    integral_result ≈ [2.0,92/15]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><h2 id="Sparse-Grid-L2(Gamma)-Norms"><a class="docs-heading-anchor" href="#Sparse-Grid-L2(Gamma)-Norms">Sparse Grid L^2(Gamma) Norms</a><a id="Sparse-Grid-L2(Gamma)-Norms-1"></a><a class="docs-heading-anchor-permalink" href="#Sparse-Grid-L2(Gamma)-Norms" title="Permalink"></a></h2><p>Often the weighted <span>$L^2(Gamma)$</span> norm is required. Squaring a polynomial approximation results in many higher degree polynomial terms –- it is not as simple as squaring the evaluations at each sparse grid point.</p><p>The precomputed <span>$L_{\rho}^2(Gamma)$</span> integrals in <code>pcl</code> are used with the sparse grid approximation structure to <em>exactly</em> compute the <span>$L_{\rho}^2(\Gamma)$</span> norm of a sparse grid polynomial function. This requires the pairwise norms of the point evaluations to be computed using <code>precompute_pairwise_norms</code>. If the evaluations are vectors, a mass matrix can be supplied in <code>(x,y)-&gt;dot(x,Q,y)</code>. </p><p>For the function <code>x</code> the weighted <span>$L_{\rho}^2([-1,1])$</span> norm is $ \Vert x^2 \Vert<em>{L</em>{\rho}^2([-1,1])} = \sqrt{3}&#39;.</p><pre><code class="language-julia hljs">    n,k = 1,1
    mi_set = create_smolyak_miset(n,k)
    sg = create_sparsegrid(mi_set)
    f_on_grid = [[x[1]] for x in get_grid_points(sg)]
    pairwise_norms = precompute_pairwise_norms(f_on_grid, (x,y)-&gt;dot(x,y))
    l2_integral_result = integrate_L2_on_sparsegrid(sg, f_on_grid, pcl)
    l2_integral_result[1] ≈ sqrt(1/3)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>Similarly, for <span>$x^2$</span> we get <span>$\Vert x^2 \Vert_{L_{\rho}^2([-1,1])}=\sqrt{5}$</span>. </p><pre><code class="language-julia hljs">    n,k = 1,3
    mi_set = create_smolyak_miset(n,k)
    sg = create_sparsegrid(mi_set)
    f_on_grid = [[x[1]^2] for x in get_grid_points(sg)]
    l2_integral_result = integrate_L2_on_sparsegrid(sg, f_on_grid, pcl)
    l2_integral_result[1] ≈ sqrt(1/5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>Finally we consider the <span>$L^2_{\rho}([-1,1]^2)$</span> norm of <span>$f(x_1)$</span>. This can be explicitly computed to be <span>$\sqrt(92/15)$</span>.</p><pre><code class="language-julia hljs">    # Test precompute_pairwise_norms
    n,k = 2,4
    mi_set = create_smolyak_miset(n,k)
    sg = create_sparsegrid(mi_set)
    f_on_grid = [[f(x[1])] for x in get_grid_points(sg)]
    pairwise_norms = precompute_pairwise_norms(f_on_grid, (x,y)-&gt;x.*y)
    l2_integral_result = integrate_L2_on_sparsegrid(sg, f_on_grid, pcl)
    l2_integral_result ≈ sqrt(92/15)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../sparsegridinterpolation/">« Sparse Grid Interpolation</a><a class="docs-footer-nextpage" href="../reference/">Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Tuesday 29 October 2024 11:36">Tuesday 29 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
